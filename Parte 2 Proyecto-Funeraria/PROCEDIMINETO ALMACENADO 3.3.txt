--CREAR PROCEDIMIENTO ALMACENADO--
CREATE OR REPLACE FUNCTION PUBLIC."GANANCIAS" (NOMBRE_ESPACIO TEXT)
RETURNS TABLE (SERVICIOS TEXT)
AS $$
DECLARE 
INGRESO RECORD;
BEGIN 
FOR INGRESO IN 
SELECT SALA_VELATORIO.NOMBRE_ESPACIO ||' '|| SUM (SERVICIO.COSTO_SERVICIO) AS NOMBRE
FROM
PUBLIC.SERVICIO,
PUBLIC.SALA_VELATORIO
WHERE 
SERVICIO.ID_ESPACIO = SALA_VELATORIO.ID_ESPACIO AND
SALA_VELATORIO.NOMBRE_ESPACIO =$1
GROUP BY SALA_VELATORIO.NOMBRE_ESPACIO
LOOP SERVICIOS := INGRESO.NOMBRE;
RETURN NEXT ;
END LOOP;
RETURN;
END; $$
LANGUAGE 'plpgsql'

--SELECCIONAR--
select * from "GANANCIAS" ('SALA MEDIANA')

